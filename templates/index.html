<!DOCTYPE html>
<html>
<head>
  <title>Error Log HL7 Parser</title>
  <link rel="icon" href="/static/favicon.ico">

  <style>
    body {
      font-family: Arial, sans-serif;
      background: #fafafa;
      margin: 0;
      padding: 0;
    }

    /* Top navigation */
    .top-bar {
      background: #ffffff;
      border-bottom: 1px solid #ccc;
      padding: 10px 16px;
      display: flex;
      justify-content: space-between;
      align-items: center;
    }

    .top-bar a {
      text-decoration: none;
      color: #b71c1c;
      font-weight: bold;
      margin-right: 12px;
    }

    /* Tabs */
    .tabs {
      display: flex;
      border-bottom: 1px solid #ccc;
      background: #f5f5f5;
    }

    .tab {
      padding: 10px 16px;
      cursor: pointer;
      border-right: 1px solid #ccc;
      background: #f5f5f5;
    }

    .tab.active {
      background: #ffffff;
      font-weight: bold;
      border-bottom: 2px solid #b71c1c;
    }

    /* Tab content */
    .tab-panel {
      display: none;
      padding: 16px;
    }

    .tab-panel.active {
      display: block;
    }

    /* Raw HL7 */
    .raw-hl7 {
      white-space: pre;
      font-family: Consolas, monospace;
      font-size: 13px;
      background: #ffffff;
      border: 1px solid #ccc;
      padding: 12px;
      overflow-x: auto;
    }

    /* PDF viewer */
    .pdf-frame {
      width: 100%;
      height: calc(100vh - 180px);
      border: none;
    }
  </style>
</head>

<body>

  <div class="top-bar">
    <div>
      <a href="/">‚Üê Back to Menu</a>
    </div>
    <div>
      <strong>Error Log HL7 Parser</strong>
    </div>
  </div>

  <!-- Tabs -->
  <div class="tabs">
    <div class="tab active" data-tab="errors">
      Errors ({{ error_count }})
    </div>
    <div class="tab" data-tab="raw">
      Raw HL7
    </div>
    <div class="tab" data-tab="pdf">
      Original PDF
    </div>
  </div>

  <!-- Tab panels -->
  <div id="tab-errors" class="tab-panel active">
    {{ parsed_output | safe }}
  </div>

  <div id="tab-raw" class="tab-panel">
    {% if raw_hl7 %}
      <div class="raw-hl7">{{ raw_hl7 }}</div>
    {% else %}
      <em>No HL7 segments extracted.</em>
    {% endif %}
  </div>

  <div id="tab-pdf" class="tab-panel">
    {% if pdf_url %}
      <iframe class="pdf-frame" src="{{ pdf_url }}"></iframe>
    {% else %}
      <em>No PDF available.</em>
    {% endif %}
  </div>

  <script>
    document.querySelectorAll(".tab").forEach(tab => {
      tab.addEventListener("click", () => {
        document.querySelectorAll(".tab").forEach(t => t.classList.remove("active"));
        document.querySelectorAll(".tab-panel").forEach(p => p.classList.remove("active"));

        tab.classList.add("active");
        document.getElementById("tab-" + tab.dataset.tab).classList.add("active");
      });
    });
  </script>

</body>
</html>
