<!DOCTYPE html>
<html>
<head>
  <title>HL7 Error Log Parser</title>
<link rel="icon" href="/static/favicon.ico" sizes="any">
<link rel="icon" type="image/png" sizes="32x32" href="/static/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="/static/favicon-16x16.png">

<link rel="apple-touch-icon" sizes="180x180" href="/static/apple-touch-icon.png">

<link rel="icon" type="image/png" sizes="192x192" href="/static/android-chrome-192x192.png">
<link rel="icon" type="image/png" sizes="512x512" href="/static/android-chrome-512x512.png">

  <style>
.nav-bar {
  background: #ffffff;
  border-bottom: 1px solid #ddd;
  padding: 8px 10px;
  margin: -20px -20px 12px -20px;
}


.back-link {
  text-decoration: none;
  font-size: 14px;
  color: #b71c1c;
  font-weight: bold;
}

.back-link:hover {
  text-decoration: underline;
}

    body {
      font-family: Arial, sans-serif;
      background: #fafafa;
      padding: 20px;
    }

    /* Card layout */
    .card {
      border: 1px solid #ccc;
      margin-bottom: 14px;
      background: #fff;
      border-radius: 4px;
    }

    .card-header {
      background: #e3f2fd;
      padding: 8px 10px;
      position: relative;
      font-size: 14px;
    }

    .card-body {
      padding: 10px;
      transition: all 0.15s ease;
    }

    /* Collapsed state */
    .card.collapsed .card-body {
      display: none;
    }

    /* Toggle button */
    .toggle {
      float: right;
      cursor: pointer;
      border: none;
      background: transparent;
      font-size: 16px;
      line-height: 1;
      padding: 0 4px;
      transition: transform 0.15s ease;
    }

    .toggle:hover {
      transform: scale(1.15);
    }

    /* Severity banners */
    .error {
      background: #fdecea;
      padding: 8px 10px;
      border-left: 4px solid #d32f2f;
      font-weight: bold;
    }

    .info {
      background: #f0f0f0;
      padding: 8px 10px;
      border-left: 4px solid #9e9e9e;
      font-style: italic;
    }

    /* Accession */
    .acc {
      background: #f7f7f7;
      padding: 8px 10px;
      margin-bottom: 10px;
      font-size: 13px;
    }

    /* Orders & OBXs */
    .order {
      margin-top: 12px;
      font-size: 14px;
    }

    .obr-line {
      margin-bottom: 6px;
      font-weight: bold;
    }

    .obx {
      margin-left: 20px;
      padding: 4px 0;
      font-size: 13px;
    }

    /* Copy button spacing */
    .obr-line button,
    .obx button {
      margin-right: 6px;
      cursor: pointer;
    }

    /* Highlighted OBX */
    .highlight {
      background: #fff3cd;
      border-left: 4px solid #ff9800;
      padding-left: 6px;
    }

<a href="/" style="display:inline-block; margin-bottom:12px;">
  ← Back to Menu
</a>

    /* Upload form */
    form {
      margin-bottom: 16px;
    }
  </style>

  <script>
    function copyText(text) {
      navigator.clipboard.writeText(text);
      alert("Copied: " + text);
    }

    function toggleCard(btn) {
      const card = btn.closest('.card');
      if (!card) return;

      const isCollapsed = card.classList.toggle('collapsed');
      btn.textContent = isCollapsed ? '▸' : '▾';
    }

    // Initialize arrow direction on load
    document.addEventListener('DOMContentLoaded', () => {
      document.querySelectorAll('.card').forEach(card => {
        const btn = card.querySelector('.toggle');
        if (!btn) return;

        btn.textContent = card.classList.contains('collapsed') ? '▸' : '▾';
      });
    });
  </script>
</head>

<body>
<div class="nav-bar">
  <a href="/" class="back-link">← Back to Menu</a>
</div>

  <h2>HL7 Error Log Parser</h2>

  <form method="post" enctype="multipart/form-data">
    <input type="file" name="file">
    <button type="submit">Parse</button>
  </form>

  <div id="output">
    {{ output|safe }}
  </div>
  <footer style="margin-top:40px; font-size:12px; color:#777; text-align:center;">
  HL7 Tools v1.1 • Authored by HUBERMAR "THING2" • marc.huber@med.usc.edu • MIT License
</footer>

</body>
</html>
